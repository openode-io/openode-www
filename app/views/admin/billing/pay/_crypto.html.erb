<h4 class="mt-3"><i class="fab fa-bitcoin text-warning"></i> Pay with Crypto</h4> 
<div class="card mt-3 mb-3">
  <div class="card-body">   
    

      <form action="/admin/billing/pay#crypto_button" method="get">
        <div class="row">
          <div class="form-label-group mb-2">
            <label for="crypto_amount">Please enter your order amount (USD)</label>
            <input class="form-control"
              placeholder="USD Amount"
              type="number"
              step="0.01"
              value="<%= params["amount"].to_f %>"
              name="amount" id="crypto_amount">
            <br />
          </div>

          <input type="submit" name="commit" value="Prepare order" class="btn btn-lg btn-success w-100 mb-3" data-disable-with="Prepare order" />
        </div>
      </form>

      <div>
        
        <hr />
      </div>

    <% if params["amount"].present? %>
      <div class="row" id="crypto_button">
        
        <div class="text-center" style="margin: auto">
          <p><strong>Order prepared. Please click the Pay button below to proceed with the payment.</strong></p>
          <br />
          
          <!-- test pk_test_buhRBFWE8qttWWTAM9v9SMhu -->
          <script src="https://js.crypto.com/sdk?publishable-key=pk_test_buhRBFWE8qttWWTAM9v9SMhu"></script>
          
          <script>
            cryptopay.Button({
              createPayment: function(actions) {
                return actions.payment.create({
                  currency: 'USD',
                  amount: <%= params["amount"].to_i*100 %>,
                  description : 'opeNode Credits',
                  //order_id: 'sample-order-id',
                  metadata: {
                    user_id: <%= @user['id'] %>
                  }
                });
              },
              onApprove: function (data, actions) {
                // Optional: add logic such as browser redirection or check data object content
              },
              defaultLang: 'en-US'
            }).render("#pay-button")
          </script>

          <div id="pay-button"></div>
        </div>

        
      </div>   

    <% end %>
  </div>
</div>        

<!--
      <div class="col-lg-2 col-md-2 col-sm-2">
        <div class="nav flex-column nav-pills" id="v-pills-tab" role="tablist" aria-orientation="vertical">
          <% @cryptos.each_with_index do |c,i| %>
            <a class="nav-link <%= i == 0 ? 'active' : '' %>"
              id="v-pills-<%= c %>-tab"
              data-toggle="pill"
              href="#v-pills-<%= c[:id] %>"
              role="tab"
              aria-controls="v-pills-<%= c[:id] %>"
              aria-selected="true"><%= c[:id].titleize %></a>
          <% end %>
        </div>
      </div>
      <div class="col-lg-10 col-md-10 col-sm-10">            
        <div class="tab-content" id="v-pills-tabContent">
          <% @cryptos.each_with_index do |crypto, i| %>
            <div class="tab-pane fade show <%= i == 0 ? 'active' : '' %>"
                 id="v-pills-<%= crypto[:id] %>"
                 role="tabpanel"
                 aria-labelledby="v-pills-<%= crypto[:id] %>-tab">
              <p><strong>Pay to (Address):</strong> <%= crypto[:addr] %></p>
              <p><strong>Memo:</strong> userid <%= @user['id'] %></p>
              
            </div>
          <% end %>

          
        </div>
      </div>

      -->

<div class="alert alert-info">
  <i class="fa fa-info-circle"></i> Important notice: The crypto payment process is manual, once your payment is done please contact us with your wallet address.
  We usually validate the transaction within few hours up to 1 business day. Thanks!          
</div>